{% extends 'base.html' %}
{% load static %}

{% block content %}
<div class="container">
    <!-- HERO SECTION-->
    <section class="py-5 bg-light">
        <div class="row px-4 px-lg-5 py-lg-4 align-items-center">                
            <div class="col-lg-6">
                <h1 class="h2 text-uppercase mb-0">All Watches</h1>                
            </div>
            <div class="col-lg-6 text-lg-right">
                <nav aria-label="breadcrumb">
                    <ol class="breadcrumb justify-content-lg-end mb-0 px-0">
                        <li class="breadcrumb-item"><a href="index.html">Home</a></li>
                        <li class="breadcrumb-item active" aria-current="page">All Watches</li>
                    </ol>
                </nav>
            </div>
        </div>
        <!-- Category Options Btns -->
        <div class="row">
            <div class="col text-center">
                <div class="container-search">
                    <div class="searchbox">
                        <input type="text" class="searchbox__input" placeholder="Search..." />
                        <svg class="searchbox__icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 56.966 56.966">
                            <path
                                d="M55.146,51.887L41.588,37.786c3.486-4.144,5.396-9.358,5.396-14.786c0-12.682-10.318-23-23-23s-23,10.318-23,23s10.318,23,23,23c4.761,0,9.298-1.436,13.177-4.162l13.661,14.208c0.571,0.593,1.339,0.92,2.162,0.92c0.779,0,1.518-0.297,2.079-0.837C56.255,54.982,56.293,53.08,55.146,51.887z M23.984,6c9.374,0,17,7.626,17,17s-7.626,17-17,17s-17-7.626-17-17S14.61,6,23.984,6z" />
                        </svg>
        
                    </div>
                </div>
        
            </div>
        </div>
        <!-- End of Category Options Btns -->
    </section>
</div>
<section class="py-5">
    <div class="container p-0">
        <div class="row">
            <!-- SHOP SIDEBAR-->
            <div class="col-lg-3 order-2 order-lg-1">
                <h5 class="text-uppercase mb-4">Categories</h5>
                <div class="py-2 px-4 bg-dark text-white mb-3"><strong
                        class="small text-uppercase font-weight-bold">Fashion &amp; Acc</strong></div>
                <ul class="list-unstyled small text-muted pl-lg-4 font-weight-normal">
                    <li class="mb-2"><a class="reset-anchor" href="#">Women's T-Shirts</a></li>
                    <li class="mb-2"><a class="reset-anchor" href="#">Men's T-Shirts</a></li>
                    <li class="mb-2"><a class="reset-anchor" href="#">Dresses</a></li>
                    <li class="mb-2"><a class="reset-anchor" href="#">Novelty socks</a></li>
                    <li class="mb-2"><a class="reset-anchor" href="#">Women's sunglasses</a></li>
                    <li class="mb-2"><a class="reset-anchor" href="#">Men's sunglasses</a></li>
                </ul>
                <div class="py-2 px-4 bg-light mb-3"><strong class="small text-uppercase font-weight-bold">Health &amp;
                        Beauty</strong></div>
                <ul class="list-unstyled small text-muted pl-lg-4 font-weight-normal">
                    <li class="mb-2"><a class="reset-anchor" href="#">Shavers</a></li>
                    <li class="mb-2"><a class="reset-anchor" href="#">bags</a></li>
                    <li class="mb-2"><a class="reset-anchor" href="#">Cosmetic</a></li>
                    <li class="mb-2"><a class="reset-anchor" href="#">Nail Art</a></li>
                    <li class="mb-2"><a class="reset-anchor" href="#">Skin Masks &amp; Peels</a></li>
                    <li class="mb-2"><a class="reset-anchor" href="#">Korean cosmetics</a></li>
                </ul>
                <div class="py-2 px-4 bg-light mb-3"><strong
                        class="small text-uppercase font-weight-bold">Electronics</strong></div>
                <ul class="list-unstyled small text-muted pl-lg-4 font-weight-normal mb-5">
                    <li class="mb-2"><a class="reset-anchor" href="#">Electronics</a></li>
                    <li class="mb-2"><a class="reset-anchor" href="#">USB Flash drives</a></li>
                    <li class="mb-2"><a class="reset-anchor" href="#">Headphones</a></li>
                    <li class="mb-2"><a class="reset-anchor" href="#">Portable speakers</a></li>
                    <li class="mb-2"><a class="reset-anchor" href="#">Cell Phone bluetooth headsets</a></li>
                    <li class="mb-2"><a class="reset-anchor" href="#">Keyboards</a></li>
                </ul>
                <h6 class="text-uppercase mb-4">Price range</h6>
                <div class="price-range pt-4 mb-5">
                    <div id="range"></div>
                    <div class="row pt-2">
                        <div class="col-6"><strong class="small font-weight-bold text-uppercase">From</strong></div>
                        <div class="col-6 text-right"><strong class="small font-weight-bold text-uppercase">To</strong>
                        </div>
                    </div>
                </div>
                <h6 class="text-uppercase mb-3">Show only</h6>
                <div class="custom-control custom-checkbox mb-1">
                    <input class="custom-control-input" id="customCheck1" type="checkbox">
                    <label class="custom-control-label text-small" for="customCheck1">Returns Accepted</label>
                </div>
                <div class="custom-control custom-checkbox mb-1">
                    <input class="custom-control-input" id="customCheck2" type="checkbox">
                    <label class="custom-control-label text-small" for="customCheck2">Returns Accepted</label>
                </div>
                <div class="custom-control custom-checkbox mb-1">
                    <input class="custom-control-input" id="customCheck3" type="checkbox">
                    <label class="custom-control-label text-small" for="customCheck3">Completed Items</label>
                </div>
                <div class="custom-control custom-checkbox mb-1">
                    <input class="custom-control-input" id="customCheck4" type="checkbox">
                    <label class="custom-control-label text-small" for="customCheck4">Sold Items</label>
                </div>
                <div class="custom-control custom-checkbox mb-1">
                    <input class="custom-control-input" id="customCheck5" type="checkbox">
                    <label class="custom-control-label text-small" for="customCheck5">Deals &amp; Savings</label>
                </div>
                <div class="custom-control custom-checkbox mb-4">
                    <input class="custom-control-input" id="customCheck6" type="checkbox">
                    <label class="custom-control-label text-small" for="customCheck6">Authorized Seller</label>
                </div>
                <h6 class="text-uppercase mb-3">Buying format</h6>
                <div class="custom-control custom-radio">
                    <input class="custom-control-input" id="customRadio1" type="radio" name="customRadio">
                    <label class="custom-control-label text-small" for="customRadio1">All Listings</label>
                </div>
                <div class="custom-control custom-radio">
                    <input class="custom-control-input" id="customRadio2" type="radio" name="customRadio">
                    <label class="custom-control-label text-small" for="customRadio2">Best Offer</label>
                </div>
                <div class="custom-control custom-radio">
                    <input class="custom-control-input" id="customRadio3" type="radio" name="customRadio">
                    <label class="custom-control-label text-small" for="customRadio3">Auction</label>
                </div>
                <div class="custom-control custom-radio">
                    <input class="custom-control-input" id="customRadio4" type="radio" name="customRadio">
                    <label class="custom-control-label text-small" for="customRadio4">Buy It Now</label>
                </div>
            </div>
            <!-- Search Results-->
            <div class="col-lg-9 order-1 order-lg-2 mb-5 mb-lg-0">
                <div class="row mb-3 align-items-center">
                    <div class="col-lg-6 mb-2 mb-lg-0">
                        {% if search_term or current_categories or current_sorting != 'None_None' %}
                        <span class="small"><a href="{% url 'watches' %}">See All Watches</a></span>
                        {% endif %}
                        <p class="text-small text-muted mb-0">{{ watches|length }} results found.</p>
                    </div>
                      
                    <div class="col-lg-6">
                        <ul class="list-inline d-flex align-items-center justify-content-lg-end mb-0">
                            <li class="list-inline-item text-muted mr-3"><a class="reset-anchor p-0" href="#"><i
                                        class="fas fa-th-large"></i></a></li>
                            <li class="list-inline-item text-muted mr-3"><a class="reset-anchor p-0" href="#"><i
                                        class="fas fa-th"></i></a></li>
                            <li class="list-inline-item">
                            <!-- SORT BY DROPDOWN -->
                            <select id="sort-selector" class="custom-select custom-select-sm rounded-0 border border-{% if current_sorting != 'None_None' %}info{% else %}black{% endif %}">
                                <option value="reset" {% if current_sorting == 'None_None' %}selected{% endif %}> Sort by...</option>
                                <option value="price_asc" {% if current_sorting == 'price_asc' %}selected{% endif %}> Price (low to high)</option>
                                <option value="price_desc" {% if current_sorting == 'price_desc' %}selected{% endif %}> Price (high to low)</option>
                                <option value="rating_asc" {% if current_sorting == 'rating_asc' %}selected{% endif %}> Rating (low to high)</option>
                                <option value="rating_desc" {% if current_sorting == 'rating_desc' %}selected{% endif %}> Rating (high to low)</option>
                            </select>
                            </li>
                        </ul>
                    </div>
                </div>
                <div class="row">
                    <!-- All Watches -->
                    {% for watch in watches %}
                    <div class="col-lg-4 col-sm-6">
                        <div class="product text-center">
                            <div class="mb-3 position-relative">
                                {% if watch.image %}
                                    {% if watch.label %}
                                <div class="badge text-white badge-danger">{{ watch.label }}</div>
                                    {% else %}
                                    <div class="badge text-white badge-secondary"></div>
                                    {% endif %}                                
                                <a class="d-block" href="{% url 'watch_detail' watch.id %}">
                                    <img class="img-fluid w-100 h-100" src="{{ watch.image.url }}" alt="{{ watch.name }}">
                                </a>
                                {% else %}
                                <div class="badge text-white badge-secondary"></div><a class="d-block"
                                    href="{% url 'watch_detail' watch.id %}"><img class="img-fluid w-100 h-100"
                                        src="{{ MEDIA_URL }}noimage.png" alt="{{ watch.name }}"></a>
                                {% endif %}
                                <!-- DISPLAYED ON HOVER  -->
                                <div class="product-overlay">
                                    <ul class="mb-0 list-inline">
                                        {% if request.user.is_superuser %}
                                        <li class="list-inline-item m-0 p-0">
                                            <a class="btn btn-sm btn-outline-dark" href="{% url 'edit_watch' watch.id %}">
                                                <i class="far fa-edit"></i>
                                            </a>
                                        </li>
                                        {% endif %}                                        
                                        <li class="list-inline-item m-0 p-0">
                                            <a class="btn btn-sm btn-dark" href="{% url 'watch_detail' watch.id %}">More Information</a>
                                        </li>
                                        {% if request.user.is_superuser %}
                                        <li class="list-inline-item mr-0">
                                            <a class="btn btn-sm btn-outline-dark" href="{% url 'delete_watch' watch.id %}">
                                                <i class="fas fa-trash"></i>
                                            </a>
                                        </li>
                                        {% endif %}
                                    </ul>
                                </div>
                                <!-- END OF DISPLAYED ON HOVER  -->
                            </div>
                            <h6> <a class="reset-anchor" href="detail.html">{{ watch.name }}</a></h6>
                            <h5 class="text-muted"> <a class="reset-anchor"
                                    href="detail.html">{{ watch.brand.friendly_name }}</a></h5>
                            <p class="text-muted my-0">£{{ watch.price }}</p>
                            <p class="small text-muted my-1">Category: 
                                <a class="reset-anchor ml-2" href="{% url 'watches' %}?category={{ watch.category.name }}">{{ watch.category.friendly_name }}</a>
                            </p>
                            <!-- Rating -->
                            <ul class="list-inline mb-2">
                                {% if watch.rating %}
                                <li class="list-inline-item m-0 text-muted"><i class="fas fa-star small text-warning">
                                        {{ watch.rating }} / 10</i></li>
                                {% else %}
                                <li class="list-inline-item m-0"><i class="fas fa-star small text-danger"> No Rating</i>
                                {% endif %}
                                </li>
                            </ul>
                            <!--end of Rating  -->
                        </div>
                    </div>
                    {% endfor %}
                    <!-- End of All Watches -->
                </div>
                    <!-- PAGINATION-->
                    <nav aria-label="Page navigation example">
                        <ul class="pagination justify-content-center justify-content-lg-end">
                            <li class="page-item"><a class="page-link" href="#" aria-label="Previous"><span
                                        aria-hidden="true">«</span></a></li>
                            <li class="page-item active"><a class="page-link" href="#">1</a></li>
                            <li class="page-item"><a class="page-link" href="#">2</a></li>
                            <li class="page-item"><a class="page-link" href="#">3</a></li>
                            <li class="page-item"><a class="page-link" href="#" aria-label="Next"><span
                                        aria-hidden="true">»</span></a></li>
                        </ul>
                    </nav>
                </div>
            </div>
        </div>
    </section>
{% endblock %}

{% block postloadjs %}
{{ block.super }}
<script type="text/javascript">
    $('#sort-selector').change(function(){
        var selector = $(this);
        var currentUrl = new URL(window.location);

        var selectedVal = selector.val();
        if (selectedVal != "reset"){
            var sort = selectedVal.split("_")[0];
            var direction = selectedVal.split("_")[1];

            currentUrl.searchParams.set("sort", sort);
            currentUrl.searchParams.set("direction", direction);

            window.location.replace(currentUrl);
        } else{
            currentUrl.searchParams.delete("sort");
            currentUrl.searchParams.delete("direction");

            window.location.replace(currentUrl);
        }
    })
</script>
{% endblock %}